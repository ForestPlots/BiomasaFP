<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin Sullivan" />

<meta name="date" content="2021-06-15" />

<title>Using BiomasaFP and BIOMASS together</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Using BiomasaFP and BIOMASS together</h1>
<h4 class="author">Martin Sullivan</h4>
<h4 class="date">2021-06-15</h4>



<p>The BIOMASS R package provides an alternative tool for calculating aboveground biomass. Unlike BiomasaFP, it hasn't been designed to run of ForestPlots.net outputs, which means it requires the user to do a bit more coding, but will be easier to use if your data are not in ForestPlots.net as it doesn't assume that there are particular columns in the data. While for biomass calculations you could use either package, not all functionality overlaps. Only the BIOMASS package provides error propagated estimates of aboveground biomass, while only BiomasaFP provides measures of forest dynamics such as woody productivity.</p>
<p>While you will probably use one package or the other for your analysis, there are a few useful functions that BIOMASS provides that can be integrated, with a bit of work, into an analysis with BiomasaFP.</p>
<div id="wood-density-lookup" class="section level2">
<h2>Wood density lookup</h2>
<p>The ForestPlots.net database has an inbuilt copy of the Chave/ Zanne et al. 2009 wood density database, which you can access using the query library. This wood density data is one of the required inputs for the mergefp function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat&lt;-<span class="kw">mergefp</span>(trees,md,wd)</code></pre></div>
<p>But the BIOMASS R package also provides a way of querying this database through the <code>getWoodDensity</code> function. You might want to do this if you are having problems running the ForestPlots query for wood density, or if you want to change some of the parameters for matching wood density (e.g. not matching at family level, not matching at continent level).</p>
<p>To use the <code>getWoodDensity</code> function, our first challange is to split the species column into seperate genus and species columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>Genus&lt;-<span class="kw">sapply</span>(dat<span class="op">$</span>Species,<span class="cf">function</span>(x)<span class="kw">strsplit</span>(x,<span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])
dat<span class="op">$</span>Sp&lt;-<span class="kw">sapply</span>(dat<span class="op">$</span>Species,<span class="cf">function</span>(x)<span class="kw">strsplit</span>(x,<span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])
<span class="kw">head</span>(dat<span class="op">$</span>Species)
<span class="co">#&gt; [1] &quot;Protium hebetatum&quot; &quot;Protium hebetatum&quot; &quot;Protium hebetatum&quot;</span>
<span class="co">#&gt; [4] &quot;Protium hebetatum&quot; &quot;Caryocar glabrum&quot;  &quot;Caryocar glabrum&quot;</span>
<span class="kw">head</span>(dat<span class="op">$</span>Genus)
<span class="co">#&gt; [1] &quot;Protium&quot;  &quot;Protium&quot;  &quot;Protium&quot;  &quot;Protium&quot;  &quot;Caryocar&quot; &quot;Caryocar&quot;</span>
<span class="kw">head</span>(dat<span class="op">$</span>Sp)
<span class="co">#&gt; [1] &quot;hebetatum&quot; &quot;hebetatum&quot; &quot;hebetatum&quot; &quot;hebetatum&quot; &quot;glabrum&quot;   &quot;glabrum&quot;</span></code></pre></div>
<p>Before we run the <code>getWoodDensity</code> function, an important step is to reduce the data to just unique tree IDs (if you don't do this, bad things will happen when you try to run <code>mergefp</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat2&lt;-<span class="kw">unique</span>(dat[,<span class="kw">c</span>(<span class="st">&quot;TreeID&quot;</span>,<span class="st">&quot;PlotID&quot;</span>,<span class="st">&quot;PlotCode&quot;</span>,<span class="st">&quot;PlotViewID&quot;</span>,<span class="st">&quot;Genus&quot;</span>,<span class="st">&quot;Sp&quot;</span>,<span class="st">&quot;Family&quot;</span>)])
<span class="kw">nrow</span>(dat)
<span class="co">#&gt; [1] 8099</span>
<span class="kw">nrow</span>(dat2)
<span class="co">#&gt; [1] 1309</span></code></pre></div>
<p>Finally, we are ready to run <code>getWoodDensity</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wd.biomass&lt;-<span class="kw">getWoodDensity</span>(dat2<span class="op">$</span>Genus,dat2<span class="op">$</span>Sp,<span class="dt">stand=</span>dat2<span class="op">$</span>PlotViewID,<span class="dt">family=</span>dat2<span class="op">$</span>Family)
<span class="co">#&gt; The reference dataset contains 16467 wood density values</span>
<span class="co">#&gt; Your taxonomic table contains 361 taxa</span>
<span class="kw">str</span>(wd.biomass)
<span class="co">#&gt; 'data.frame':    1309 obs. of  7 variables:</span>
<span class="co">#&gt;  $ family : chr  &quot;Burseraceae&quot; &quot;Caryocaraceae&quot; &quot;Lecythidaceae&quot; &quot;Lecythidaceae&quot; ...</span>
<span class="co">#&gt;  $ genus  : chr  &quot;Protium&quot; &quot;Caryocar&quot; &quot;Eschweilera&quot; &quot;Eschweilera&quot; ...</span>
<span class="co">#&gt;  $ species: chr  &quot;hebetatum&quot; &quot;glabrum&quot; &quot;tessmannii&quot; &quot;coriacea&quot; ...</span>
<span class="co">#&gt;  $ meanWD : num  0.568 0.654 0.789 0.852 0.533 ...</span>
<span class="co">#&gt;  $ sdWD   : num  0.0941 0.0708 0.0708 0.0708 0.0708 ...</span>
<span class="co">#&gt;  $ levelWD: chr  &quot;genus&quot; &quot;species&quot; &quot;species&quot; &quot;species&quot; ...</span>
<span class="co">#&gt;  $ nInd   : int  31 7 1 12 3 4 5 13 5 32 ...</span></code></pre></div>
<p>Now append the mean wood density for each stem to our data, and then restrict the columns so they match the ForestPlots.net wood density output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat2<span class="op">$</span>WD&lt;-wd.biomass<span class="op">$</span>meanWD
wd2&lt;-<span class="kw">data.frame</span>(<span class="st">&quot;PlotID&quot;</span>=dat2<span class="op">$</span>PlotID,<span class="st">&quot;PlotCode&quot;</span>=dat2<span class="op">$</span>PlotCode,<span class="st">&quot;PlotViewID&quot;</span>=dat2<span class="op">$</span>PlotViewID,<span class="st">&quot;TreeID&quot;</span>=dat2<span class="op">$</span>TreeID,<span class="st">&quot;WD&quot;</span>=dat2<span class="op">$</span>WD)</code></pre></div>
<p>We can now proceed with <code>mergefp</code> as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat3&lt;-<span class="kw">mergefp</span>(trees,md,wd2)</code></pre></div>
</div>
<div id="height-diameter-allometry" class="section level2">
<h2>Height-diameter allometry</h2>
<p>BIOMASS has nice functions for fitting height-diameter models and plotting fits of different models against the input data.</p>
<p>The first thing we have to do is to covert the diameter data from mm into cm (BiomasaFP height-diameter functions do this in the function, but BIOMASS expects the inputs in cm).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>D.cm&lt;-dat<span class="op">$</span>D4<span class="op">/</span><span class="dv">10</span></code></pre></div>
<p>You can fit height-diameter models across multiple plots at once in BIOMASS, but you only get the nice graphical output if you look at one plot at a time, so we'll look at each plot in turn.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(dat[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;JEN-11&quot;</span>,],<span class="kw">modelHD</span>(D.cm,Height))
<span class="co">#&gt; To build a HD model you must use the parameter 'method' in this function</span>
<span class="co">#&gt;      method  color      RSE    RSElog  Average_bias</span>
<span class="co">#&gt; 1      log1   blue 4.169132 0.1634860  0.0015729103</span>
<span class="co">#&gt; 2      log2  green 4.067784 0.1619454  0.0008976036</span>
<span class="co">#&gt; 3   weibull orange 4.054683        NA -0.0001152028</span>
<span class="co">#&gt; 4 michaelis purple 4.043162        NA -0.0001060615</span>
<span class="kw">with</span>(dat[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;CAP-09&quot;</span>,],<span class="kw">modelHD</span>(D.cm,Height))
<span class="co">#&gt; To build a HD model you must use the parameter 'method' in this function</span>
<span class="co">#&gt;      method  color      RSE    RSElog  Average_bias</span>
<span class="co">#&gt; 1      log1   blue 6.039085 0.2232796  0.0039239120</span>
<span class="co">#&gt; 2      log2  green 5.999312 0.2218205  0.0031984494</span>
<span class="co">#&gt; 3   weibull orange 5.981388        NA -0.0002227037</span>
<span class="co">#&gt; 4 michaelis purple 5.960755        NA -0.0007356204</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>We can use the RSE and bias values to select the best model, and also use the graphical outputs.</p>
<p>Let's go with the Michaelis-Menten model to use for both plots. Refit the models specifying which type of model to use, and extract the coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1&lt;-<span class="kw">with</span>(dat[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;JEN-11&quot;</span>,],<span class="kw">modelHD</span>(D.cm,Height,<span class="dt">method=</span><span class="st">&quot;michaelis&quot;</span>))<span class="op">$</span>coefficients
m2&lt;-<span class="kw">with</span>(dat[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;CAP-09&quot;</span>,],<span class="kw">modelHD</span>(D.cm,Height,<span class="dt">method=</span><span class="st">&quot;michaelis&quot;</span>))<span class="op">$</span>coefficients</code></pre></div>
<p>Now our challenge is to get this output into a format that can be used with BiomasaFP. The BiomasaFP R package takes a height parameters dataset with the tree ID, a, b and c parameters for each tree, and the type of model for each tree. The code below sets that up:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h.params2&lt;-<span class="kw">data.frame</span>(<span class="st">&quot;TreeID&quot;</span>=<span class="kw">unique</span>(dat<span class="op">$</span>TreeID),<span class="st">&quot;a_par&quot;</span>=<span class="ot">NA</span>,<span class="st">&quot;b_par&quot;</span>=<span class="ot">NA</span>,<span class="st">&quot;Model&quot;</span>=<span class="ot">NA</span>)
h.params2<span class="op">$</span>a_par[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;JEN-11&quot;</span>]]&lt;-m1[<span class="dv">1</span>,<span class="dv">1</span>]
h.params2<span class="op">$</span>b_par[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;JEN-11&quot;</span>]]&lt;-m1[<span class="dv">2</span>,<span class="dv">1</span>]
h.params2<span class="op">$</span>Model[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;JEN-11&quot;</span>]]&lt;-<span class="st">&quot;MicMent&quot;</span>
h.params2<span class="op">$</span>a_par[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;CAP-09&quot;</span>]]&lt;-m2[<span class="dv">1</span>,<span class="dv">1</span>]
h.params2<span class="op">$</span>b_par[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;CAP-09&quot;</span>]]&lt;-m2[<span class="dv">2</span>,<span class="dv">1</span>]
h.params2<span class="op">$</span>Model[h.params2<span class="op">$</span>TreeID<span class="op">%in%</span>dat<span class="op">$</span>TreeID[dat<span class="op">$</span>PlotCode<span class="op">==</span><span class="st">&quot;CAP-09&quot;</span>]]&lt;-<span class="st">&quot;MicMent&quot;</span>
<span class="co"># Need a c_par variable</span>
h.params2<span class="op">$</span>c_par&lt;-<span class="ot">NA</span>

<span class="kw">head</span>(h.params2)
<span class="co">#&gt;    TreeID    a_par    b_par   Model c_par</span>
<span class="co">#&gt; 1 1186624 46.80975 22.88332 MicMent    NA</span>
<span class="co">#&gt; 2 1186625 46.80975 22.88332 MicMent    NA</span>
<span class="co">#&gt; 3 1186626 46.80975 22.88332 MicMent    NA</span>
<span class="co">#&gt; 4 1186627 46.80975 22.88332 MicMent    NA</span>
<span class="co">#&gt; 5 1187406 46.80975 22.88332 MicMent    NA</span>
<span class="co">#&gt; 6 1187407 46.80975 22.88332 MicMent    NA</span></code></pre></div>
<p>Now we can run the <code>SummaryAGWP</code> function with the new height data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dynamics.mic&lt;-<span class="kw">SummaryAGWP</span>(dat,AGBChv14,<span class="dt">height.data=</span>h.params2)

<span class="kw">summary</span>(dynamics.mic)
<span class="co">#&gt;    PlotViewID      Census.No         AGB.ha         Stems.ha    </span>
<span class="co">#&gt;  Min.   :112.0   Min.   :1.000   Min.   :300.5   Min.   :486.0  </span>
<span class="co">#&gt;  1st Qu.:112.0   1st Qu.:2.250   1st Qu.:309.1   1st Qu.:494.2  </span>
<span class="co">#&gt;  Median :112.0   Median :4.000   Median :313.8   Median :597.0  </span>
<span class="co">#&gt;  Mean   :124.5   Mean   :4.286   Mean   :343.8   Mean   :563.2  </span>
<span class="co">#&gt;  3rd Qu.:147.0   3rd Qu.:5.750   3rd Qu.:399.2   3rd Qu.:601.8  </span>
<span class="co">#&gt;  Max.   :147.0   Max.   :9.000   Max.   :426.6   Max.   :620.0  </span>
<span class="co">#&gt;                                                                 </span>
<span class="co">#&gt;    AGWPrec.ha       Recruit.ha      AGBmort.ha      Mortality.ha  </span>
<span class="co">#&gt;  Min.   :0.1553   Min.   : 3.00   Min.   : 3.364   Min.   : 9.00  </span>
<span class="co">#&gt;  1st Qu.:0.4953   1st Qu.: 8.50   1st Qu.: 7.305   1st Qu.:11.00  </span>
<span class="co">#&gt;  Median :1.1568   Median :20.00   Median :13.409   Median :16.50  </span>
<span class="co">#&gt;  Mean   :0.9788   Mean   :16.58   Mean   :15.678   Mean   :17.83  </span>
<span class="co">#&gt;  3rd Qu.:1.4059   3rd Qu.:24.00   3rd Qu.:16.063   3rd Qu.:22.75  </span>
<span class="co">#&gt;  Max.   :1.7759   Max.   :28.00   Max.   :49.721   Max.   :32.00  </span>
<span class="co">#&gt;  NA's   :2        NA's   :2       NA's   :2        NA's   :2      </span>
<span class="co">#&gt;   AGWPsurv.ha     SurvivingStems.ha UnobsAGWPmort.ha     Mean.WD      </span>
<span class="co">#&gt;  Min.   : 5.087   Min.   :  0.0     Min.   :0.03923   Min.   :0.6619  </span>
<span class="co">#&gt;  1st Qu.: 7.444   1st Qu.:469.8     1st Qu.:0.07197   1st Qu.:0.6659  </span>
<span class="co">#&gt;  Median :10.708   Median :573.0     Median :0.11713   Median :0.6683  </span>
<span class="co">#&gt;  Mean   :15.401   Mean   :469.7     Mean   :0.26307   Mean   :0.6679  </span>
<span class="co">#&gt;  3rd Qu.:16.631   3rd Qu.:586.0     3rd Qu.:0.28086   3rd Qu.:0.6710  </span>
<span class="co">#&gt;  Max.   :47.034   Max.   :609.0     Max.   :0.93066   Max.   :0.6714  </span>
<span class="co">#&gt;  NA's   :2                          NA's   :2                         </span>
<span class="co">#&gt;  Recruitment.stem.year Mortality.stem.year UnobsAGWPrec.ha    UnobsRecruits.ha </span>
<span class="co">#&gt;  Min.   :0.004414      Min.   :0.005830    Min.   :0.004012   Min.   :0.07946  </span>
<span class="co">#&gt;  1st Qu.:0.006499      1st Qu.:0.008194    1st Qu.:0.008933   1st Qu.:0.16853  </span>
<span class="co">#&gt;  Median :0.010767      Median :0.012093    Median :0.010545   Median :0.19751  </span>
<span class="co">#&gt;  Mean   :0.012352      Mean   :0.014804    Mean   :0.012099   Mean   :0.22257  </span>
<span class="co">#&gt;  3rd Qu.:0.019355      3rd Qu.:0.018850    3rd Qu.:0.014637   3rd Qu.:0.26515  </span>
<span class="co">#&gt;  Max.   :0.023914      Max.   :0.036578    Max.   :0.022154   Max.   :0.39922  </span>
<span class="co">#&gt;  NA's   :2             NA's   :2           NA's   :2          NA's   :2        </span>
<span class="co">#&gt;  CensusInterval     AGWP.ha        AGWP.ha.year     PlotCode        </span>
<span class="co">#&gt;  Min.   :0.929   Min.   : 0.000   Min.   :3.737   Length:14         </span>
<span class="co">#&gt;  1st Qu.:1.174   1st Qu.: 6.272   1st Qu.:5.492   Class :character  </span>
<span class="co">#&gt;  Median :2.033   Median :10.982   Median :6.264   Mode  :character  </span>
<span class="co">#&gt;  Mean   :3.007   Mean   :14.275   Mean   :5.966                     </span>
<span class="co">#&gt;  3rd Qu.:3.903   3rd Qu.:15.470   3rd Qu.:6.672                     </span>
<span class="co">#&gt;  Max.   :7.978   Max.   :49.751   Max.   :7.326                     </span>
<span class="co">#&gt;  NA's   :2                        NA's   :2</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
